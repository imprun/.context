# STORY-15.3: Cluster Health Widget

## 1. ê°œìš”
**Epic**: EPIC-015 Fleet Dashboard
**ì œëª©**: í´ëŸ¬ìŠ¤í„° ìƒíƒœ ëª©ë¡ ìœ„ì ¯
**ë‹´ë‹¹ì**: AI Agent
**ìƒíƒœ**: âœ… ì™„ë£Œ (ë³€í˜• êµ¬í˜„)

## 2. ëª©ì 
í´ëŸ¬ìŠ¤í„°ë³„ ì—ì´ì „íŠ¸ ìƒíƒœë¥¼ ì‹œê°ì ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ìœ„ì ¯ì„ êµ¬í˜„í•œë‹¤.

## 3. EPIC ì„¤ê³„ vs í˜„ì¬ êµ¬í˜„

### EPIC ì„¤ê³„
ê°œë³„ í´ëŸ¬ìŠ¤í„° ëª©ë¡ê³¼ ê° í´ëŸ¬ìŠ¤í„°ì˜ Agent ìƒíƒœ:
```
â”Œâ”€ Cluster í˜„í™© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â— kr-prod-cluster                        â— Active  3/3 Agents â”‚  â”‚
â”‚  â”‚   Region: kr-central | Last heartbeat: 1 min ago              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â—‹ kr-dev-cluster                       â—‹ Inactive  0/1 Agents â”‚  â”‚
â”‚  â”‚   Region: kr-central | Last heartbeat: 1 hour ago   âš ï¸        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í˜„ì¬ êµ¬í˜„: System Health Widget
**Path**: `web/src/widgets/operator/dashboard/cluster-health-widget.tsx`

ì§‘ê³„ ë°ì´í„° ê¸°ë°˜ì˜ ì‹œìŠ¤í…œ í—¬ìŠ¤ í‘œì‹œ:
```
â”Œâ”€ System Health â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚  ğŸ–¥ï¸ Clusters                                              [View all] â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘                              â”‚
â”‚  2 active                                                 3 total    â”‚
â”‚                                                                       â”‚
â”‚  ğŸ¤– Agents                                                [View all] â”‚
â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘                            â”‚
â”‚  6 connected                                              8 total    â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â— System Healthy                                              â”‚   â”‚
â”‚  â”‚   75% of agents are connected                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4. í˜„ì¬ êµ¬í˜„ ìƒì„¸

### 4.1. ì»´í¬ë„ŒíŠ¸
```tsx
interface ClusterHealthWidgetProps {
  stats: OperatorDashboardStats | undefined;
  isLoading: boolean;
}

export function ClusterHealthWidget({ stats, isLoading }: ClusterHealthWidgetProps)
```

### 4.2. ê¸°ëŠ¥
- **Clusters Progress Bar**: í™œì„± í´ëŸ¬ìŠ¤í„° ë¹„ìœ¨
- **Agents Progress Bar**: ì—°ê²°ëœ Agent ë¹„ìœ¨
- **System Status**: ì „ì²´ ì‹œìŠ¤í…œ í—¬ìŠ¤ ìƒíƒœ
  - â‰¥80%: "System Healthy" (ì´ˆë¡)
  - â‰¥50%: "Some Issues Detected" (ì£¼í™©)
  - <50%: "Critical Issues" (ë¹¨ê°•)
- **ë§í¬**: "View all" í´ë¦­ ì‹œ ê° ëª©ë¡ í˜ì´ì§€ë¡œ ì´ë™

### 4.3. ìƒ‰ìƒ ë¡œì§
```typescript
const connectedPercentage = (connected_agents / total_agents) * 100;

// Progress bar ìƒ‰ìƒ
if (connectedPercentage < 50) return "bg-red-500";
if (connectedPercentage < 80) return "bg-orange-500";
return "bg-emerald-500";
```

## 5. ê°œì„  ê°€ëŠ¥ ì‚¬í•­ (ì„ íƒì )

EPIC ì„¤ê³„ëŒ€ë¡œ ê°œë³„ í´ëŸ¬ìŠ¤í„° ëª©ë¡ì„ í‘œì‹œí•˜ë ¤ë©´:

### 5.1. ì¶”ê°€ API í•„ìš”
```
GET /api/v1/operator/dashboard/clusters
```

ì‘ë‹µ:
```typescript
interface ClusterSummary {
  id: string;
  name: string;
  region: string;
  status: ClusterStatus;
  agent_count: number;
  active_agent_count: number;
  last_heartbeat?: string;
}
```

### 5.2. ìƒˆ ìœ„ì ¯ ìƒì„±
`web/src/widgets/operator/dashboard/cluster-list-widget.tsx`

> **í˜„ì¬ ê²°ì •**: ì§‘ê³„ ê¸°ë°˜ System Healthê°€ MVPì— ì í•©. ê°œë³„ í´ëŸ¬ìŠ¤í„° ëª©ë¡ì€ `/operator/clusters`ì—ì„œ í™•ì¸ ê°€ëŠ¥.

## 6. ìˆ˜ìš© ê¸°ì¤€
- [x] í´ëŸ¬ìŠ¤í„° í™œì„±í™” ë¹„ìœ¨ì´ Progress barë¡œ í‘œì‹œëœë‹¤.
- [x] Agent ì—°ê²° ë¹„ìœ¨ì´ Progress barë¡œ í‘œì‹œëœë‹¤.
- [x] ì „ì²´ ì‹œìŠ¤í…œ í—¬ìŠ¤ ìƒíƒœê°€ í‘œì‹œëœë‹¤.
- [x] ë¬¸ì œ ìƒí™©(ì—°ê²°ë¥  ë‚®ìŒ)ì´ ìƒ‰ìƒìœ¼ë¡œ ê°•ì¡°ëœë‹¤.
- [x] "View all" í´ë¦­ ì‹œ ëª©ë¡ í˜ì´ì§€ë¡œ ì´ë™í•œë‹¤.

## 7. ì°¸ì¡° íŒŒì¼
- `web/src/widgets/operator/dashboard/cluster-health-widget.tsx`
- `web/src/shared/components/ui/progress.tsx`

## 8. ë¹„ê³ 
- EPIC ì„¤ê³„ì˜ "ê°œë³„ í´ëŸ¬ìŠ¤í„° ëª©ë¡"ì€ ì§‘ê³„ ê¸°ë°˜ "System Health"ë¡œ ë³€í˜• êµ¬í˜„
- ê°œë³„ í´ëŸ¬ìŠ¤í„° ìƒì„¸ëŠ” `/operator/clusters` í˜ì´ì§€ì—ì„œ í™•ì¸ ê°€ëŠ¥
- ì¶”í›„ ìš”êµ¬ ì‹œ EPIC ì„¤ê³„ëŒ€ë¡œ ê°œë³„ ëª©ë¡ ìœ„ì ¯ ì¶”ê°€ ê°€ëŠ¥
